import{j as s,L as x,a as h,b as j,c as N,r as v}from"./index-DF-I8wqH.js";import{A as u}from"./ArrowIcon-xy7xfbh9.js";import{A as g}from"./Alert-TtmXVApb.js";import{C as f}from"./ContentNotFound-DVSDmGeN.js";function w({title:r,subtitle:i,to:e}){return s.jsxs(x,{to:e,className:"link",children:[s.jsxs("div",{children:[s.jsx("p",{className:"link-title",children:r}),s.jsx("p",{className:"link-subtitle",children:i})]}),s.jsx("div",{className:"arrow",children:s.jsx(u,{})})]})}function A({user:r}){var t;const i=h(),{data:e,loading:o,error:n}=j(),{surveyPassed:c}=N(),[d,l]=v.useState(!1),m=(r==null?void 0:r.id)||0,p=a=>{if(e!=null&&e.enter_survey&&!c){l(!0),setTimeout(()=>l(!1),1e3);return}fetch("/api/course_viewed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:a,userId:m})}).catch(console.error),i(`/lessons/${a}`)};return n?s.jsxs("div",{className:"error",children:["Ошибка: ",n]}):s.jsxs("div",{className:"courses-wrapper content main-content",children:[s.jsxs("section",{className:"courses",children:[s.jsxs("div",{className:"courses-title",children:[s.jsx("img",{src:(r==null?void 0:r.photo_url)||"avatar.jpg",alt:"Аватар",className:"avatar"}),s.jsx("h2",{children:"Мои курсы"})]}),(e==null?void 0:e.enter_survey)&&!c&&s.jsxs("div",{className:"survey-banner",children:[s.jsx("p",{children:"Пройдите входное тестирование, чтобы получить доступ к курсам"}),s.jsx("button",{className:"btn",onClick:()=>i("/lessons/enter-survey"),children:"Пройти"})]}),o?s.jsx("div",{className:"loading",children:"Загрузка курсов..."}):(t=e==null?void 0:e.courses)!=null&&t.length?e.courses.map(a=>s.jsxs("div",{className:"card course-card",onClick:()=>p(a.id),children:[s.jsx("div",{className:"course-header",children:s.jsx("img",{src:"/images/logo.png",alt:"Course",className:"logo"})}),s.jsxs("div",{className:"course-body",children:[s.jsx("p",{className:"card-title",children:a.title}),s.jsxs("div",{className:"course-footer",children:[s.jsxs("div",{className:"tag",children:[(a.newprice||a.oldprice)&&s.jsx("img",{src:"/images/free.png",alt:"price-icon"}),a.oldprice&&s.jsx("span",{className:"old-price",children:a.oldprice}),a.newprice&&s.jsx("span",{className:"new-price",children:a.newprice})]}),s.jsx("span",{className:"start-btn",children:"Начать"})]})]})]},a.id)):s.jsx(f,{message:"Курсы не найдены"})]}),s.jsx(w,{title:"Предстоящие мероприятия",subtitle:"Стримы, бэктесты, разбор позиции.",to:"/calendar"}),d&&s.jsx(g,{text:"Пройдите входное тестирование"})]})}export{A as default};
