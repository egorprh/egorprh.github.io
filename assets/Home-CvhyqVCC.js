import{j as s,L as p,a as x,b as j,c as v,r as N}from"./index-BAtzdYWh.js";import{A as u}from"./ArrowIcon-CwvHoIGw.js";import{A as g}from"./Alert-E1ftcsyc.js";function f({title:r,subtitle:i,to:e}){return s.jsxs(p,{to:e,className:"link",children:[s.jsxs("div",{children:[s.jsx("p",{className:"link-title",children:r}),s.jsx("p",{className:"link-subtitle",children:i})]}),s.jsx("div",{className:"arrow",children:s.jsx(u,{})})]})}function k({user:r}){var t;const i=x(),{data:e,loading:o,error:c}=j(),{surveyPassed:n}=v(),[d,l]=N.useState(!1),m=(r==null?void 0:r.id)||1,h=a=>{if(e!=null&&e.enter_survey&&!n){l(!0),setTimeout(()=>l(!1),1e3);return}fetch("/api/course_viewed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:a,userId:m})}).catch(console.error),i(`/lessons/${a}`)};return c?s.jsxs("div",{className:"error",children:["Ошибка: ",c]}):s.jsxs("div",{className:"courses-wrapper content main-content",children:[s.jsxs("section",{className:"courses",children:[s.jsxs("div",{className:"courses-title",children:[s.jsx("img",{src:(r==null?void 0:r.photo_url)||"avatar.jpg",alt:"Аватар",className:"avatar"}),s.jsx("h2",{children:"Мои курсы"})]}),(e==null?void 0:e.enter_survey)&&!n&&s.jsxs("div",{className:"survey-banner",children:[s.jsx("p",{children:"Пройдите входное тестирование, чтобы получить доступ к курсам"}),s.jsx("button",{className:"btn",onClick:()=>i("/lessons/enter-survey"),children:"Пройти"})]}),o?s.jsx("div",{className:"loading",children:"Загрузка курсов..."}):(t=e==null?void 0:e.courses)!=null&&t.length?e.courses.map(a=>s.jsxs("div",{className:"card course-card",onClick:()=>h(a.id),children:[s.jsx("div",{className:"course-header",children:s.jsx("img",{src:"/images/logo.png",alt:"Course",className:"logo"})}),s.jsxs("div",{className:"course-body",children:[s.jsx("p",{className:"card-title",children:a.title}),s.jsxs("div",{className:"course-footer",children:[s.jsxs("div",{className:"tag",children:[(a.newprice||a.oldprice)&&s.jsx("img",{src:"/images/free.png",alt:"price-icon"}),a.oldprice&&s.jsx("span",{className:"old-price",children:a.oldprice}),a.newprice&&s.jsx("span",{className:"new-price",children:a.newprice})]}),s.jsx("span",{className:"start-btn",children:"Начать"})]})]})]},a.id)):s.jsx("div",{children:"Курсы не найдены"})]}),s.jsx(f,{title:"Предстоящие мероприятия",subtitle:"Стримы, бэктесты, разбор позиции.",to:"/calendar"}),d&&s.jsx(g,{text:"Пройдите входное тестирование"})]})}export{k as default};
