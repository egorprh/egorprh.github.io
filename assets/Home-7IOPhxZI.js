import{j as s,L as h,a as p,b as x,c as j,r as N}from"./index-XklZpoUB.js";import{A as v}from"./ArrowIcon-hbW_neGk.js";import{A as g}from"./Alert-CaKFDipm.js";function u({title:i,subtitle:r,to:a}){return s.jsxs(h,{to:a,className:"link",children:[s.jsxs("div",{children:[s.jsx("p",{className:"link-title",children:i}),s.jsx("p",{className:"link-subtitle",children:r})]}),s.jsx("div",{className:"arrow",children:s.jsx(v,{})})]})}function k({user:i}){var l;const r=p(),{data:a,loading:n,error:c}=x(),{surveyPassed:t}=j(),[o,f]=N.useState(!1),d=(i==null?void 0:i.id)||1,m=e=>{fetch("/api/course_viewed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({courseId:e,userId:d})}).catch(console.error),r(`/lessons/${e}`)};return c?s.jsxs("div",{className:"error",children:["Ошибка: ",c]}):s.jsxs("div",{className:"courses-wrapper content main-content",children:[s.jsxs("section",{className:"courses",children:[s.jsxs("div",{className:"courses-title",children:[s.jsx("img",{src:(i==null?void 0:i.photo_url)||"avatar.jpg",alt:"Аватар",className:"avatar"}),s.jsx("h2",{children:"Мои курсы"})]}),(a==null?void 0:a.enter_survey)&&!t&&s.jsxs("div",{className:"survey-banner",children:[s.jsx("p",{children:"Пройдите входное тестирование, чтобы получить доступ к курсам"}),s.jsx("button",{className:"btn",onClick:()=>r("/lessons/enter-survey"),children:"Пройти"})]}),n?s.jsx("div",{className:"loading",children:"Загрузка курсов..."}):(l=a==null?void 0:a.courses)!=null&&l.length?a.courses.map(e=>s.jsxs("div",{className:"card course-card",onClick:()=>m(e.id),children:[s.jsx("div",{className:"course-header",children:s.jsx("img",{src:"/images/logo.png",alt:"Course",className:"logo"})}),s.jsxs("div",{className:"course-body",children:[s.jsx("p",{className:"card-title",children:e.title}),s.jsxs("div",{className:"course-footer",children:[s.jsxs("div",{className:"tag",children:[(e.newprice||e.oldprice)&&s.jsx("img",{src:"/images/free.png",alt:"price-icon"}),e.oldprice&&s.jsx("span",{className:"old-price",children:e.oldprice}),e.newprice&&s.jsx("span",{className:"new-price",children:e.newprice})]}),s.jsx("span",{className:"start-btn",children:"Начать"})]})]})]},e.id)):s.jsx("div",{children:"Курсы не найдены"})]}),s.jsx(u,{title:"Предстоящие мероприятия",subtitle:"Стримы, бэктесты, разбор позиции.",to:"/calendar"}),o&&s.jsx(g,{text:"Пройдите входное тестирование"})]})}export{k as default};
